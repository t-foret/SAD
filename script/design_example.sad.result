 *** Welcome to SAD Ver.1.3.8.0k64 built at 2025-10-19 21:36:05 +0900 ***
 *** Today: 21:36:06 Sunday 10/19/2025 ***
 OFF LOG;ON ECHO;READ 77 ;           1
!
!   This is an example of SAD/FFS to design a positron ring
!   with unit cells and dispersion suppressors.   Chromaticity correction
!   and also a survey of dynamic aperture are also done.
!      The result of execution of this example is available in
!   /SAD/doc/design_example.sad.result
!
MOMENTUM= 1 GEV;
ON ECHO;OFF CTIME;
!
! ***** DEFINITION OF ELEMENTS IN MAIN LEVEL *****
!
 ;
 DRIFT  L1     = (L = 1)
 ;
 BEND   B      = (L = 2)
 ;
 QUAD   QF     = (L = 1 K1 =  0.15 )
        QD     = (L = 1 K1 = -0.15 )
        QSF    = (L = 1 K1 =  0.15 )
        QSD    = (L = 1 K1 = -0.15 )
        QRF    = (L = 1 K1 =  0.15 )
        QRD    = (L = 1 K1 = -0.15 )
 ;
 SEXT   SF     =(L = 1 K2 = 0.1)
        SD     =(L = 1 K2 = -0.2)
 ;
 MARK   IP1     =(BETAX = 10   BETAY =10    EMIX = 4.0E-7
           EMIY = 4.0E-7  DP = 0.01 )
 ;
 CAVI   CA1 = (L = 1  VOLT=1 MV HARM=100)
 ;
!
! ***** DEFINITION OF UNIT CELL IN MAIN LEVEL *****
!
!     You need at least one LINE to start FFS, but
!     other lines can be created in FFS.
!
 ;
 LINE   CELL = (IP1 QF L1 SF L1 B 3*L1 QD L1 SD L1 B 3*L1)
 ;
 FFS USE=CELL;
 *** SADScript Initialization: /home/tmori/work/accelerator/github/SAD/Packages/init.n ***
 *** Run time Environment:     /home/tmori/work/accelerator/github/SAD/Packages/init.local.n ***
 RFSW RADCOD RAD  FLUC  INTRA POL   COD  DAPER EMIOU K64   FOURI SMEAR
   F     F     F     T     F     F     T     F     F     T     F     T
   Print[TimeUsed[]];! CPU Time used so far.
.011574000120162964
 !
 ! Defining parameters:
 !
   nbends=24;        ! number of bends per ring
   nxcell=0.25;      ! horizontal tune/cell
   nycell=0.25;      ! vertical tune/cell
   Print[TimeUsed[]];! CPU Time used so far.
.011591999791562557
 !
 !  *****  UNIT CELL MATCHING  *****
 !
   CELL;             ! peridic condition
   B 2*Pi/nbends;    ! settin bending angle to the BEND B
   FIT;              ! set fit point at end of line
   NX nxcell;        ! set fit condition NX
   NY nycell;        ! set fit condition NY
   FREE Q*;          ! set Q* (in this case QF and QD) as the matching
                     ! variable
   GO;               ! start matching
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   5.4663E-05  (NEWTON)    1.000          2
 Matched. ( 1.4400E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  -1.496562 $$$       f BX    #######  #  23.647688 $$$       f NX   .25       1    .250000
$$$       f AY    #######  #    .467389 $$$       f BY    #######  #   6.097781 $$$       f NY   .25       1    .250000
$$$       f LENG  #######  #  18.000000
 
 !                     define dr as the drawing command (needs X-Window)
 !  dr:=FFS["OUT 'a' DRAW BX BY & EX EY {BQ}*; TERM OUT; TDR 'a';"];
   dr:=FFS["DRAW BX BY & EX EY {BQ}*;"];
   dr;               ! draw optics of unit cell
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
   SAVE;             ! save the matching result (values of QF, QD) to
                     ! keep them after swtch the beam line.
   Print[TimeUsed[]];! CPU Time used so far.
.15805700421333313
 !
 ! *****  DISPERSION SUPPRESSOR  *****
 !
   unitcell=ExtractBeamLine[];   ! get the current BeamLine
 !                     define a dispersion suppressor to insert rf
   supp=BeamLine[QSF, 8*L1, QSD, 3*L1, B, 3*L1, QRF, 3*L1, CA1, 3*L1, QRD];
   USE Join[unitcell, supp];     ! switch the beam line with suppressor
   INS;              ! now nonperiodic (a transport line)
   QRD L 0.5;        ! set the thickness of QD
   FIT; 
   AX 0;             ! set the end of line to be a symmetry point
   AY 0;             
   EX 0;             ! and dispersion-free
   EPX 0;
   Q*F MIN 0;        ! set the lower limit of K1 of QRF, QSF
   Q*D MAX 0;        ! set the upper limit of K1 of QRD, QSD 
   FREE QS* QR*;
   GO; 
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   1.6727E+08  (NEWTON)    1.000          4
       3        0   3.6729E+07  (NEWTON)    1.000          4
       4        0   2.1048E+05  (NEWTON)    1.000          4
       5        0    3.422      (NEWTON)    1.000          4
       6        0    1.805      (NEWTON)    1.000          4
      18        0    1.704      (NEWTON)    1.000          4
      21        0    1.616      (NEWTON)    1.000          4
      23        0    1.396      (NEWTON)    1.000          4
      24        0   0.4509      (NEWTON)    1.000          4
      25        0   8.2613E-02  (NEWTON)    1.000          4
      26        0   2.6685E-04  (NEWTON)    1.000          4
 Matched. ( 2.1659E-11) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX   0         1  1.2735E-6 $$$       f BX    #######  #  11.291325 $$$       f NX    #######  #    .587538
$$$       f AY   0         1  4.4763E-6 $$$       f BY    #######  #  95.005438 $$$       f NY    #######  #    .797327
$$$       f EX   0         1  2.488E-15 $$$       f EPX  0         1  -1.38E-16 $$$       f LENG  #######  #  44.500000
   dr;               ! draw suppressor
   SAVE;
   Print[TimeUsed[]];! CPU Time used so far.
.2101690024137497
 !
 ! ***** TOTAL RING *****
 !
   ncell=(nbends/2-2)/2;   ! number of unitcells per half ring.
 !                     Defining a half ring, removing the
 !                     first QF and IP1 markers in unitcell
   hring=BeamLine[IP1,-supp,Rest[ncell*Rest[unitcell]],supp];
   USE Join[hring,-hring]; ! switch to full ring
   CELL;             ! now periodic condition again
 !  CAL NX NY;        ! set to display NX and NY after CAL (default)
   CAL               ! calculate the optics of ring
 Matched. (  0.000    ) DP = 0.01000  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
$$$       f AX    #######  #  3.775E-15 $$$       f BX    #######  #  11.291350 $$$       f NX    #######  #   3.836969
$$$       f AY    #######  #  -3.55E-15 $$$       f BY    #######  #  95.005631 $$$       f NY    #######  #   4.635740
$$$       f LENG  #######  #  284.00000
   dr;               ! draw ring
   Print[TimeUsed[]];! CPU Time used so far.
.23942899703979492
 !
 ! ***** CHROMATICITY CORRECTION *****
 !                   
 !                     get the current tunes
   {nx0, ny0}=Twiss[{"NX","NY"},"***"]/2/Pi;
   REJ TOTAL;        ! reject all matching conditions;
   FIT;
   NX nx0 8;         ! set the offmomentum tunes for 8 points
   NY ny0 8;         ! in -DP < dp/p0 < DP
   DP=0.024;         ! set the bandwidth |dp/p0|max = DP = 0.024
   FIX *;            ! fix all variables;
   FREE S*;          ! set S* (SF and SD) sextupoles as variable
   GO;
 Iterations Unstable Residual    Method     Reduction  Variables
       2        0   6.8031E-03  (NEWTON)    1.000          2
 *****qcod---> Closed orbit not found            1
 *****qcod---> Closed orbit not found            2
 *****qcod---> Closed orbit not found            3
 *****qcod---> Closed orbit not found            4
 Residual = 6.8031E-03  DP = 0.02400  DP0 = 0.00000  ExponentOfResidual = 2.0  OffMomentumWeight =   1.000  CALEXP  
expected integer but got "neue"
    (processing "-font" option)
    invoked from within
".5.1v.2f create text  0 0   -font "helvetica neue"   -altfont "-*-symbol-medium-r-normal-*-14-*-*-*-*-*-*-*"   -altscriptfont "-*-symbol-medium-r-norm..."
            DP                 -.024000  -.018000  -.012000  -.006000   .000000   .006000   .012000   .018000   .024000
            Res.                .003056 5.5927E-4 6.3408E-5 1.7650E-6   .000000 2.4822E-5 2.1144E-4 7.9750E-4   .002089
$$$       f AX    #######  #  3.438E-11 1.416E-11 -4.37E-14 9.770E-15 3.775E-15 2.598E-14 2.027E-12 1.585E-11 6.542E-11
$$$       f BX    #######  #  12.922419 11.646218 11.303774 11.240548 11.291350 11.377437 11.443252 11.437883 11.305979
$$$       f NX   3.83697   8   3.868539  3.848145  3.839472  3.836339  3.836969  3.840563  3.846671  3.855022  3.865474
$$$       f AY    #######  #  4.849E-13 6.548E-11 -2.18E-12 -1.30E-13 -3.55E-15 -1.81E-13 -1.16E-11 -6.73E-11 -2.09E-10
$$$       f BY    #######  #  130.99888 116.56285 107.71422 100.98552 95.005631 89.035383 82.736458 76.068926 69.171817
$$$       f NY   4.63574   8   4.678050  4.655364  4.642920  4.636841  4.635740  4.638858  4.645674  4.655773  4.668789
$$$       f LENG  #######  #  284.00000
   FITP 1;           ! set the off-momentum points to 1 (on-momentum only).
     !
     ! Define Functions to display tunes as functions of dp/p0
   nx[dp_]:=(DP0=dp;FFS["CALC"];Twiss["NX","***"]/2/Pi);
   ny[dp_]:=(DP0=dp;FFS["CALC"];Twiss["NY","***"]/2/Pi);
     !
     ! Plot tunes -3% < dp/p0 < 3%.
   Plot[{nx[dp],ny[dp]}, {dp, -0.03, 0.03},
     PlotRange->{3.7,4.8},
     PlotLabel->"Tune Chromaticity",
     FrameLabel->{{"`fD`np/p`d0`n","F   X X"},{"`fn`n`dx`n, `fn`n`dy`n","GX X  GX X"}}];
???Tkinter::tclerror:  Error in Tcl: 1501 in Tcl[".5.1v.2f create text  0 0   -font \"helvetica neue\"   -altfont \"-*-symbol-medium-r-normal-*-14-*-*-*-*-*-*-*\"   -altscriptfont \"-*-symbol-medium-r-normal-*-12-*-*-*-*-*-*-*\"   -scriptfont \"-*-helvetica-medium-r-normal-*-10-*-*-*-*-*-*-*\"   -tags \"dummytag\"   -text \"`fD`np/p`d0`n\"   "]
... in StandardForm[TclEval[".5.1v.2f create text "//
   TclArgFontReplace[{{0,0},Text->"`fD`np/p`d0`n",Tags->"dummytag",
     Font->"helvetica neue"}]]]
... in If[0,
 Module[{{op1,op2}=SwitchCases[{Tags->"dummytag",Font->"helvetica neue"},
     {Rule|RuleDelayed[Angle|Font|Justify|UseBG|Fill,_],_}],
 ...
... in CanvasGraphics`o2P$["`fD`np/p`d0`n",{0,0},Tags->"dummytag",
 Font->"helvetica neue"]
... in Module[{bb},
 CanvasGraphics`o2P$["`fD`np/p`d0`n",{0,0},Tags->"dummytag",Font->
    "helvetica neue"];
 ...
... in CanvasGraphics`o3l$["`fD`np/p`d0`n","helvetica neue"]
... in If[1,
 Round[(CanvasGraphics`o3l$["`fD`np/p`d0`n",CanvasGraphics`oZ$][[1]] 
   GetFontSize[CanvasGraphics`oZ$]^-1)],
 ...
... in CanvasGraphics`o3j$["`fD`np/p`d0`n",16]
... in Module[{bl,fl=CanvasGraphics`oO$[Height]},
 Do[bl=CanvasGraphics`oO$[BBox[{"LF$X2"//i,"FL$X2"//i,"F$X2"//i}]];
    If[bl<=>{}&&bl[[2]]>653&&bl[[1]]<=536<=bl[[3]],fl=Min[fl,bl[[2]]]],
 ...
... in CanvasGraphics`o3f$["`fD`np/p`d0`n",756.1846153846154,
 18.516125132405637,{536,653},"n"]
... in Module[{{pos,w,anc}=CanvasGraphics`o30$["BOTTOM"],sz,it=0},
 While[Not[RealQ[w]],
   If[it++>10,Return[]];Sleep[.3];{pos,w,anc}=CanvasGraphics`o30$["BOTTOM"]];
 ...
... in CanvasGraphics`o2h$["`fD`np/p`d0`n",18.516125132405637,"BOTTOM"]
... in CanvasGraphics`o2h$[{"`fD`np/p`d0`n","F   X X"},18.516125132405637,
 "BOTTOM"]
... in If[1,CanvasGraphics`o2h$[#,Restrict[#3,9,28],#2]]
... in If[""<=>#<=>{"",""},CanvasGraphics`o2h$[#,Restrict[#3,9,28],#2]]&
 [{"`fD`np/p`d0`n","F   X X"},"BOTTOM",18.516125132405637]
... in ScanThread[If[""<=>#<=>{"",""},
   CanvasGraphics`o2h$[#,Restrict[#3,9,28],#2]]&,
 {{{"`fD`np/p`d0`n","F   X X"},{"`fn`n`dx`n, `fn`n`dy`n","GX X  GX X"},"",""},
 ...
... in If[1,
 ft$1=CanvasGraphics`o2c$[ft$1];ts$1=Take[Flatten[{ts$1,ts$1}],2];{wsfx$1,
    wsfy$1}=
 ...
... in If[1,
 If[fr$1<=>0,ft$1=CanvasGraphics`o2c$[ft$1];ts$1=Take[Flatten[{ts$1,ts$1}],2];
   {wsfx$1,wsfy$1}=
 ...
... in Module[{fl,pl,ft,wsx,wsy,wsfx,wsfy,det,wc,fr,tag,t1,t2,addtag,enc,
  glist,ws,pr,id,l1,align,up,ts,frid,fclk,dr,plr,sca,gr,ib,tkf,frt,frt1,rmo,
  op=
 ...
... in StandardForm[Module[{fl,pl,ft,wsx,wsy,wsfx,wsfy,det,wc,fr,tag,t1,t2,
   addtag,enc,glist,ws,pr,id,l1,align,up,ts,frid,fclk,dr,plr,sca,gr,ib,tkf,
